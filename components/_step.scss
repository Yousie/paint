////
/// Steps
/// @group steps
/// @since v0.8.32
////

/// Default settings

/// @example html - Steps with border and icons
///   <ol class="steps with-border with-icons">
///     <li><a>First Step</a></li>
///     <li class="highlighted" ><a>Second Step</a></li>
///     <li class="active"><span>Current</span></li>
///     <li><span>Inactive</span></li>
///     <li><span>Inactive</span></li>
///     <li><span>Inactive</span></li>
///   </ol>
///
/// @example scss - Custom steps
///   .basic-breadbrumb,
///   .border-steps,
///   .icon-steps {
///     @extend %steps;
///   }
///
///   .icon-steps {
///     @extend %steps-with-icons;
///   }
///
///   .border-steps {
///     @extend %steps-with-border;
///   }

$step-default-settings: (
  height: $base-line-height * .75,

  colors: (
    inactive: border,
    highlighted: link,
    active: primary
  ),

  selectors: (
    highlighted: '.highlighted',
    active: '.active'
  )
);

$step: () !default;
$step: map-merge-settings($step-default-settings, $step);

$include-html-paint-step: true !default;

@function step-settings($setting, $property: null) {
  @if $property {
    @return map-get(map-get($step, $setting), $property);
  } @else {
    @return map-get($step, $setting);
  }
}

%steps {
  @extend %grid-row;

  li {
    display: inline-block;
    float: left;
    margin: $column-gutter / 4 0;

    &::after {
      color: color(step-settings(colors, inactive), dark);
      content: '\00bb';
      display: inline-block;
      margin: 0 $column-gutter / 4;
    }

    &:last-of-type::after {
      display: none;
    }

    > * {
      color: color(step-settings(colors, inactive), dark);
      display: inline-block;
    }

    &#{step-settings(selectors, highlighted)} > * {
      color: color(step-settings(colors, highlighted));
    }

    &#{step-settings(selectors, active)} > * {
      color: color(step-settings(colors, active));
    }
  }

  .no-touch & a:hover {
    color: color(step-settings(colors, highlighted));
  }
}

%steps-with-icons {
  li {
    &#{step-settings(selectors, highlighted)} > * {
     @include icon(check);
    }

    &#{step-settings(selectors, active)} > * {
     @include icon(dot-circle-o);
    }

    > * {
      @include icon(circle-o);

      line-height: step-settings(height) !important;

      &:before {
        margin-right: $column-gutter / 4;
      }
    }
  }
}

%steps-with-border {
  @media #{$medium-up} {
    text-align: center;

    li {
      position: relative;
      float: none;
      margin: $column-gutter / 4 $column-gutter $column-gutter / 4 0;

      &:last-of-type {
        margin-right: 0;
      }

      &::after {
        background: color(step-settings(colors, inactive));
        content: '';
        height: 2px;
        left: 100%;
        margin: 0;
        position: absolute;
        top: 50%;
        transform: translateY(-50%) translateX(-1px);
        width: 100%;
      }

      &#{step-settings(selectors, highlighted)} {
        &:after {
          background-color: color(step-settings(colors, highlighted));
        }

        > * {
          color: contrast(color(step-settings(colors, highlighted)));
          background-color: color(step-settings(colors, highlighted));
        }
      }

      &#{step-settings(selectors, active)} {
        &:after {
          background-color: color(step-settings(colors, active));
        }

        > * {
          color: contrast(color(step-settings(colors, active)));
          background-color: color(step-settings(colors, active));
        }
      }

      > * {
        background-color: color(step-settings(colors, inactive));
        border-radius: $global-radius;
        color: color(step-settings(colors, inactive), dark);
        line-height: step-settings(height);
        padding: $column-gutter / 4 $column-gutter / 2 !important;
        position: relative;
        z-index: 1;
      }

      .no-touch & > *:hover {
        background-color: color(step-settings(colors, highlighted), dark);
      }

    }
  }
};

@include exports('paint-step') {
  @if $include-html-paint-step {
    .steps {
      @extend %steps;

      &.with-border {
        @extend %steps-with-border;
      }

      &.with-icons {
        @extend %steps-with-icons;
      }
    }
  }
}
