$layout-main-block: '.application' !default;
$layout-content-wrapper-block: 'main' !default;
$layout-content-block: '.content' !default;
$layout-sidebar-block: '.sidebar' !default;

$layout-sidebar-nav-width: rem-calc(260px) !default;
$layout-sidebar-nav-width-collapsed: $layout-sidebar-nav-width * 0.25 !default;
$layout-sidebar-nav-background-color: #191c1f !default;
$layout-sidebar-nav-text-color: #f2f2f2 !default;

$layout-sidebar-nav-title-background-color: lighten($layout-sidebar-nav-background-color, 5%) !default;
$layout-sidebar-nav-title-text-color: darken($layout-sidebar-nav-text-color, 50%) !default;
$layout-sidebar-nav-title-height: rem-calc(60px) !default;

$layout-sidebar-nav-link-height: rem-calc(80px) !default;
$layout-sidebar-nav-link-icon-padding: rem-calc(10px) !default;
$layout-sidebar-nav-link-icon-roundness: rem-calc(10px) !default;
$layout-sidebar-nav-link-text-color: darken($layout-sidebar-nav-text-color, 30%) !default;

$layout-sidebar-header-height: rem-calc(80px) !default;
$layout-sidebar-footer-height: rem-calc(60px) !default;

$layout-sidebar-nav-classes: dashboard, paint, settings !default;
$layout-sidebar-nav-icons: dashboard, paint-brush, cog !default;

$include-html-layout: true !default;

%layout-sidebar-heading {
  @extend %heading-small-uppercase;

  font-weight: $font-weight-normal;
}

@mixin navigation-icon-classes(
  $classes-list: $layout-sidebar-nav-classes,
  $icons-list: $layout-sidebar-nav-icons
) {
  @for $i from 1 through length($classes-list) {
    $class-name: nth($classes-list, $i);
    $icon-value: nth($icons-list, $i);

    .#{$class-name} i {
      @include icon($icon-value);
    }
  }
}

@mixin layout-sidebar(
  $include-header: true,
  $header-block: 'header',
  $include-footer: true,
  $footer-block: 'footer'
) {
  $nav-top-margin: 0;
  $nav-bottom-margin: 0;

  @if $include-header {
    $nav-top-margin: $layout-sidebar-header-height;
  }

  @if $include-footer {
    $nav-bottom-margin: $layout-sidebar-footer-height;
  }

  #{$layout-sidebar-block} {
    background-color: $layout-sidebar-nav-background-color;
    float: left;
    height: 100%;
    position: relative;
    width: $layout-sidebar-nav-width;

    @if $include-header {
      > #{$header-block} {
        height: $layout-sidebar-header-height;
        line-height: $layout-sidebar-header-height;
        padding: 0 $column-gutter / 2;

        img {
          @include single-transition(padding, 150ms, linear);

          height: rem-calc(30px);
          margin-right: $column-gutter / 2;
          width: rem-calc(30px);
        }

        h1 {
          @extend %layout-sidebar-heading;

          color: $white;
          display: inline-block;
          margin: 0;
        }
      }
    }

    > nav {
      bottom: $nav-bottom-margin;
      left: 0;
      overflow-y: scroll;
      position: absolute;
      right: 0;
      top: $nav-top-margin;

      header {
        background-color: $layout-sidebar-nav-title-background-color;
        color: $layout-sidebar-nav-title-text-color;
        line-height: $layout-sidebar-nav-title-height;
        padding: 0 $column-gutter / 2;
        white-space: nowrap;

        h1 {
          @extend %layout-sidebar-heading;

          color: $layout-sidebar-nav-link-text-color;
          display: inline-block;
          margin: 0;
        }

        .toggle-collapse {
          color: $layout-sidebar-nav-link-text-color;
          display: inline-block;
          float: right;
          font-size: rem-calc(18px);
          line-height: $layout-sidebar-nav-title-height;

          button {
            @include icon(caret-square-o-left);

            background-color: transparent;
            border-width: 0;
          }
        }
      }

      > ul {
        @include navigation-icon-classes();

        list-style-type: none;
        margin: 0;
        padding: 0;

        a {
          @include single-transition(color, 150ms, linear);
          @include single-transition(background-color, 150ms, linear);
          @include single-transition(margin, 150ms, linear);
          @include single-transition(padding, 150ms, linear);

          border-bottom: 1px solid $layout-sidebar-nav-title-background-color;
          display: block;
          font-size: $paragraph-font-size;
          font-weight: $font-weight-normal;
          line-height: $layout-sidebar-nav-link-height;
          padding: 0 $column-gutter;
          text-decoration: none;
          white-space: nowrap;

          &, &:visited {
            color: $layout-sidebar-nav-link-text-color;
          }

          &:hover {
            background-color: $layout-sidebar-nav-title-background-color;
          }
        }

        i {
          @include single-transition(margin, 150ms, linear);

          background-color: $layout-sidebar-nav-title-background-color;
          border-radius: $layout-sidebar-nav-link-icon-roundness;
          color: $layout-sidebar-nav-link-text-color;
          margin-right: $column-gutter / 2;
          padding: $layout-sidebar-nav-link-icon-padding;
        }
      }
    }

    @if $include-footer {
      #{$footer-block} {
        background: $layout-sidebar-nav-title-background-color;
        bottom: 0;
        color: $layout-sidebar-nav-link-text-color;
        height: $layout-sidebar-footer-height;
        left: 0;
        line-height: $layout-sidebar-footer-height;
        position: absolute;
        right: 0;
      }
    }

    &.collapsed {
      width: $layout-sidebar-nav-width-collapsed;

      @if $include-header {
        > #{$header-block} {
          text-align: center;

          img {
            margin-right: 0;
          }
        }
      }

      > nav > ul a {
        padding: 0 $column-gutter / 2;
        text-align: center;

        > i {
          margin-right: 0;
        }

        > span {
          display: none;
        }
      }

      header {
        text-align: center;

        h1 {
          display: none;
        }

        .toggle-collapse {
          button {
            @include icon(caret-square-o-right);
          }

          float: none;
          margin-bottom: 0;
        }
      }

      @if $include-footer {
        #{$footer-block} {
        }
      }
    }
  }
}

@mixin layout {
  html, body {
    height: 100%;
    overflow: hidden;
  }

  #{$layout-main-block} {
    height: 100%;

    > #{$layout-content-wrapper-block} {
      height: 100%;
      overflow: hidden;
      position: relative;

      > #{$layout-content-block} {
        height: 100%;
        overflow-y: scroll;
      }
    }
  }
}

@include exports("layout") {
  @if $include-html-layout {
    @include layout();
    @include layout-sidebar();
  }
}