////
/// Buttons
/// @group global
/// @since v1.0.0
////

$button-defaults: (
  prefix: '%button',

  style: (
    base: (
      background: color(white) color(border, light),
      border: color(border) color(border, dark)
    ),
    primary: (
      background: color(primary)
    ),
    secondary: (
      background: color(link)
    ),
    disabled: (
      background: color(border),
      border: color(border, dark)
    )
  ),

  size: (
    small: gutter(size, smaller),
    base: gutter(size, small) gutter(size, base),
    large: gutter(size, base) gutter(size, base)
  ),

  radius: border(radius),
  mod: circle square disabled
);

$button: () !default;
$button: map-merge-settings($button-defaults, $button);

@function button($settings...) {
  @return map-deep-get($button, $settings...);
}

@mixin button-style($style: base) {
  $background: button(style, $style, background);
  $background-hover: nth($background, length($background));

  @if length($background) > 1 {
    $background: nth($background, 1);
  }

  $border: if(button(style, $style, border), button(style, $style, border), $background);
  $border-hover: nth($border, length($border));

  @if length($border) > 1 {
    $border: nth($border, 1);
  }

  background-color: $background;
  border: 1px solid $border;
  color: contrast($background, $dark: color(text, small));

  &:hover,
  &--hover {
    background-color: $background-hover;
    border: 1px solid $border-hover;
    color: contrast($background-hover, $dark: color(text));
  }
}

@mixin button-size($size: button(size, base)) {
  padding: $size;
}

%_button-reset {
  appearance: none;
  border: 0;
  cursor: pointer;
  text-decoration: none;
  user-select: none;

  &--hover,
  &--focus,
  &:active,
  &:focus {
    outline: none;
  }
}

%_button-base {
  @include button-size;

  border-radius: button(radius);
  font-weight: font(weight, bold);
}

// Extra button styles / mods
%_button-style {
  &-disabled {
    cursor: not-allowed;
    opacity: .5;
  }

  &-circle {
    border-radius: 1000px;
  }

  &-square {
    border-radius: 0;
  }
}

@mixin button-placeholders {
  #{button(prefix)} {
    @each $style, $color in button(style) {
      &-#{$style} {
        @extend %_button-reset;
        @extend %_button-base;
        @extend %_button-style--#{$style} !optional;
        @include button-style($style);
      }

      @each $size, $value in button(size) {
        &--#{$size} {
          @include button-size($value);
        }
      }

      @each $mod in button(mod) {
        &--#{$mod} {
          @extend %_button-style-#{$mod};
        }
      }
    }
  }
}

@include exports('paint-button') {
  @include button-placeholders;
}
